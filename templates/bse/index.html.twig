<!DOCTYPE html>
<html lang="fr">
    <head>
        <meta charset="UTF-8">
        <title>Acceuil</title>
        <link rel="stylesheet" href="{{ asset('assets/w3.css')}}">
        <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
        <link href="{{ asset('assets/bootstrap/bootstrap.min.css') }}" rel="stylesheet">
        <script src="{{ asset('assets/bootstrap/bootstrap.bundle.min.js') }}"></script>
        <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" rel="stylesheet">
        
        <style>
            * {
                box-sizing: border-box;
            }

            body, h1, h2, h3, h4, h5, h6 {
                font-family: "Times New Roman", Times, serif;
            }

            a{
                text-decoration: none;
                color: black;
            }

            .container {
                min-height: 350px;
                background: #fff;
                border-radius: 2px;
                overflow: hidden;
                box-shadow: 0 14px 28px rgba(0, 0, 0, 0.15);
                margin-bottom: 5%;
            }

            /* Refonte du menu de navigation pour mieux utiliser W3.CSS */
            #nav {
                width: 20%;
                height: 100vh;
                position: fixed;
                top: 0;
                left: 0;
                z-index: 999;
                padding-top: 20px;
            }

            #nav a {
                display: block;
                margin: 10px 0;
            }

            /* Mobile Responsiveness */
            @media(max-width: 1050px) {
                #nav {
                    width: 100%;
                    position: relative;
                    height: auto;
                }
            }

            .content-wrapper {
                margin-left: 22%;
                padding: 20px;
            }

            /* Refonte des boutons */
            .w3-button {
                margin-bottom: 10px;
            }
            #nouveau{
                margin-right: 10px;
            }
            #active{
                color: yellow;
            }
            .detail{
                float: right;
                margin-bottom: 2%;
            }
        </style>
    </head>
    <body>
        {# Vérifiez si l'utilisateur a le rôle ADMIN #}
        {% if is_granted('ROLE_ADMIN') %}

            {# Contenue pour l'administrateur #}
            <div class="w3-row">

                {# bare de navigation pour l'administrateur #}
                <div class="w3-col w3-yellow" id="nav">
                    <a href="{{path('app_home_page')}}">
                        <button class="w3-button w3-block w3-left-align">
                            <i class="fa fa-home w3-opacity"></i> 
                            Acceuil
                        </button>
                    </a>
                    <a href="{{path('user_index')}}">
                        <button class="w3-button w3-block w3-left-align">
                            <i class="fa fa-users w3-opacity"></i> 
                            Missionnaire
                        </button>
                    </a>
                    <a href="{{path('bse_index')}}">
                        <button class="w3-button w3-block w3-left-align" id="active">
                            <i class="fas fa-briefcase"></i>
                            Mission
                        </button>
                    </a>
                    <a href="{{path('depart_index')}}">
                        <button class="w3-button w3-block w3-left-align">
                            <i class="fas fa-car"></i>
                            Depart
                        </button>
                    </a>
                    <a href="{{path('payment_index')}}">
                        <button class="w3-button w3-block w3-left-align">
                            <i class="fas fa-dollar-sign"></i> 
                            Payement
                        </button>
                    </a>
                    <a href="{{path('bureau_index')}}">
                        <button class="w3-button w3-block w3-left-align">
                            <i class="fas fa-building"></i>
                            Agence
                        </button>
                    </a>
                    <a href="{{path('credit_index')}}">
                        <button class="w3-button w3-block w3-left-align">
                            <i class="fas fa-sync"></i>
                            Renouveller credit
                        </button>
                    </a>
                </div>




                <div class="w3-container content-wrapper">

            <div class="w3-bar  w3-padding">
            <button class="w3-bar-item w3-button w3-blue" onclick="openModal('Creation')" id="tous">Creation</button>
            <button class="w3-bar-item w3-button" onclick="openModal('Validation')" id="bst">Validation</button>
            <button class="w3-bar-item w3-button" onclick="openModal('Refuse')" id="ordreRoute">Refuse</button>
            <div  class="w3-center w3-bar-item w3-display-topright w3-margin">
                                    <i class="fa fa-bell w3-opaModal w3-margin-left"  onclick="document.getElementById('notify').style.display='block'"></i>
                                    <i class="fa fa-user-circle w3-opaModal w3-margin-left"   onclick="document.getElementById('profile').style.display='block'"></i>
                                    <i class="fa fa-bars w3-opaModal w3-margin-left"  onclick="document.getElementById('treebars').style.display='block'"></i>
                                </div>
            </div>

            <div id="Creation" class="w3-container w3-display-container Modal">
                                {# liste Ordre de route deja paye #}
                                <div>
                                    <input class="w3-input w3-border w3-bar-item  w3-margin-right w3-margin-bottom" type="text" placeholder="Rechercher ..."id="myInput" onkeyup="myFunction('myTable','myInput',2)">
                                    {# Corp du Liste Ordre de route deja paye   contenue #}
                                    <div>
                                        <table class="w3-table w3-bordered"  id="myTable">
                                                <tr class="w3-light-grey">
                                                    <th>Matricule</th>
                                                    <th>Nom</th>
                                                    <th>Prenom</th>
                                                    <th>Fonction</th>
                                                    <th>Taux Journalier</th>
                                                    <th>Titre</th>
                                                    <th></th>
                                                    <th></th>
                                                    <th></th>
                                                </tr>
                                            {% for user in user %}
                                                <tr class="">
                                                    <td>{{ user.matricule }}</td>
                                                    <td>{{ user.nom }}</td>
                                                    <td>{{ user.prenom }}</td>
                                                    <td>{{ user.fonction }}</td>
                                                    <td>{{ user.tauxJournalier }}</td>
                                                    <td>{{ user.titre }}</td>
                                                    <td>
                                                        <a href="{{ path('user_show', {id: user.id}) }}" class="w3-button w3-light-grey w3-small"><i class="fas fa-eye"></i> Voir</a>
                                                    </td>
                                                    <td>
                                                        <a href="{{ path('ordreRoute_new', {id: user.matricule}) }}"><boutton class="w3-button w3-blue w3-hover-yellow">Créer OR</boutton></a>
                                                    </td>
                                                    <td>
                                                        <a href="{{ path('bst_new', {id: user.matricule}) }}"><boutton class="w3-button w3-blue w3-hover-yellow">Créer OR/BST</boutton></a>
                                                    </td>
                                                </tr>
                                            {% endfor %}
                                        </table>
                                    </div>
                                </div>
            </div>

            <div id="Validation" class="w3-container w3-display-container Modal" style="display:none">
                                    {# Corp du Liste BST non payer  contenue #}
                                    <div>
                                    <input class="w3-input w3-border w3-bar-item  w3-margin-right w3-margin-bottom" type="text" placeholder="Rechercher ..."id="myInput1" onkeyup="myFunction('myTable1','myInput1',2)">
                                        <table  class="w3-table w3-bordered" id="myTable1">
                                            <tr class="w3-light-grey">
                                                <th>Création</th>
                                                <th>Destination</th>
                                                <th>Matricule</th>
                                                <th>Durée</th>
                                                <th>Etat</th>
                                                <th></th>
                                                <th></th>
                                            </tr>
                                            {% for bse_validation_attente in bse_validation_attente %}
                                                <tr>
                                                    <td>{{ bse_validation_attente.dateBse|date('Y-m-d') }}</td>
                                                    <td>{{ bse_validation_attente.destination }}</td>
                                                    <td>{{ bse_validation_attente.matricule }}</td>
                                                    <td>{{ bse_validation_attente.dureeMission }}</td>
                                                    <td>{{ bse_validation_attente.etat }}</td>

                                                    {% if (bse_validation_attente.etat == 'Ordre de route sans BST') %}
                                                        <td>
                                                            <a href="{{ path('bse_valide_or', {id: bse_validation_attente.id, matricule: bse_validation_attente.matricule}) }}"><boutton class="w3-button w3-blue w3-hover-yellow">Valider</button></a>
                                                        </td>
                                                        <td>
                                                            <a href="{{ path('bse_valide_or', {id: bse_validation_attente.id, matricule: bse_validation_attente.matricule}) }}"><boutton class="w3-button w3-blue w3-hover-yellow">Imprimer non valide</button></a>
                                                        </td>
                                                    {% elseif (bse_validation_attente.etat == 'Ordre de route avec BST')%}
                                                        <td>
                                                            <a href="{{ path('bse_valide_or_bst', {id: bse_validation_attente.id, matricule: bse_validation_attente.matricule}) }}"><boutton class="w3-button w3-blue w3-hover-yellow">Valider</button></a>
                                                        </td>
                                                        <td>
                                                            <a href="{{ path('bse_valide_or_bst', {id: bse_validation_attente.id, matricule: bse_validation_attente.matricule}) }}"><boutton class="w3-button w3-blue w3-hover-yellow">Imprimer non valider</button></a>
                                                        </td>
                                                    {% endif %}
                                                </tr>
                                            {% endfor %}
                                        </table>
                                    </div>
            </div>

            <div id="Refuse" class="w3-container w3-display-container Modal" style="display:none">
                                    <div>
                                    <input class="w3-input w3-border w3-bar-item  w3-margin-right w3-margin-bottom" type="text" placeholder="Rechercher ..."id="myInput2" onkeyup="myFunction('myTable2','myInput2',2)">
                                        <table  class="w3-table w3-bordered" id="myTable2">
                                            <tr class="w3-light-grey">
                                                <th>Création BSE</th>
                                                <th>IM user</th>
                                                <th>Durée</th>
                                                <th>IM détenteur</th>
                                                <th>Destination</th>
                                                <th>Lieu BSE</th>
                                                <th></th>
                                            </tr>
                                            {% for validation_refuse in validation_refuse %}
                                                <tr>
                                                    <td>{{ validation_refuse.dateBse|date('Y-m-d') }}</td>
                                                    <td>{{ validation_refuse.matricule }}</td>
                                                    <td>{{ validation_refuse.dureeMission }}</td>
                                                    <td>{{ validation_refuse.detenteur }}</td>
                                                    <td>{{ validation_refuse.destination }}</td>
                                                    <td>{{ validation_refuse.lieuBse}}</td>
                                                    
                                                {% if (validation_refuse.etat == 'Ordre de route sans BST') %}
                                                    <td>
                                                        <a href="{{ path('bse_edit', {id: validation_refuse.id, matricule: validation_refuse.matricule}) }}"><boutton class="w3-button w3-blue w3-hover-yellow">Modifier</button></a>
                                                    </td>
                                                {% elseif (validation_refuse.etat == 'Ordre de route avec BST')%}
                                                    <td>
                                                        <a href="{{ path('bse_edit', {id: validation_refuse.id, matricule: validation_refuse.matricule}) }}"><boutton class="w3-button w3-blue w3-hover-yellow">Modifier</button></a>
                                                    </td>
                                                {% endif %}
                                                </tr>
                                            {% endfor %}
                                        </table>
            </div>
                        </div>



                        {#
                            <div>
                                {# premier contenue }
                                <div class="contenue1 w3-container content-wrapper" id="creation">
                                    {# Entete du premier contenue }
                                    <div>
                                        <div class="w3-row-padding w3-margin-bottom">
                                            <center>
                                                <h4 class="w3-text-indigo" ><b>Création d'un ordre de route avec ou sans BST</b></h4>
                                            </center>
                                        </div>
                                        <div class="w3-row-padding w3-margin-bottom">
                                            <div  class="w3-twothird">
                                                <a href="#creation"><button class="w3-button w3-yellow">Création</button></a>
                                                <a href="#validation"><button class="w3-button">Validation</button></a>
                                                <a href="#refuse"><button class="w3-button ">Refusé</button></a>
                                            </div>
                                            <div  class="w3-third">
                                                <input class="w3-input w3-border " type="text" placeholder="Rechercher un missionnaire..." id="myInput" onkeyup="myRecherche('myTable','myInput',1)">
                                            </div>
                                        </div>
                                    </div>
                                    
                                    {# Corp du premier contenue }
                                    <div id="creation" class="w3-container Mission">
                                    </div>
                                </div>

                                {# deuxieme contenue }
                                <div class="contenue2 w3-container content-wrapper" id="validation">
                                    {# Entete du deuxième contenue }
                                    <div>
                                        <div class="w3-row-padding w3-margin-bottom w3-border w3-border-indigo">
                                            <center>
                                                <h4 class="w3-text-indigo" ><b>Validation d'un ordre de route avec ou sans BST</b></h4>
                                            </center>
                                        </div>
                                        <div class="w3-row-padding w3-margin-bottom">
                                            <div  class="w3-twothird">
                                                <a href="#creation"><button class="w3-button">Création</button></a>
                                                <a href="#validation"><button class="w3-button w3-yellow">Validation</button></a>
                                                <a href="#refuse"><button class="w3-button">Refusé</button></a>
                                            </div>
                                            <div  class="w3-third">
                                                <input class="w3-input w3-border " type="text" placeholder="Rechercher par destination..." id="myInputAttente" onkeyup="myRecherche('myTableAttente','myInputAttente',0)">
                                            </div>
                                        </div>
                                    </div>
                                    
                                    {# Corp du deuxieme contenue }
                                    <div id="validation" class="w3-container Mission">
                                    </div>
                                </div>

                                {# troisième contenue }
                                <div class="contenue3 w3-container content-wrapper" id="refuse">
                                    {# Entete du troisieme contenue }
                                    <div>
                                        <div class="w3-row-padding w3-margin-bottom w3-border w3-border-indigo">
                                            <center>
                                                <h4 class="w3-text-indigo" ><b>Ordre de route avec ou sans BST refusé</b></h4>
                                            </center>
                                        </div>
                                        <div class="w3-row-padding w3-margin-bottom">
                                            <div  class="w3-twothird">
                                                <a href="#creation"><button class="w3-button">Création</button></a>
                                                <a href="#validation"><button class="w3-button">Validation</button></a>
                                                <a href="#refuse"><button class="w3-button w3-yellow">Refusé</button></a>
                                            </div>
                                            <div  class="w3-third">
                                                <input class="w3-input w3-border " type="text" placeholder="Rechercher par motif..." id="myInputRefuse" onkeyup="myRecherche('myTableRefuse','myInputRefuse',0)">
                                            </div>
                                        </div>
                                    </div>
                                    
                                    {# Corp du troisieme contenue }
                                    <div id="refuse" class="w3-container Mission">
                                        
                                    </div>
                                </div>
                            </div>#}


                                {# modal profile pour l'administrateur #}
                                <div class="Modal">
                                    <div id="profile" class="w3-modal">
                                        <div  class="w3-modal-content w3-animate-top">
                                            <div class=" w3-display-topmiddle w3-white w3-padding w3-round-xlarge">
                                                <span onclick="document.getElementById('profile').style.display='none'" class="w3-button w3-display-topright w3-circle">&times;</span>
                                                <center>
                                                    {% if app.user.sexe == 'Femme' %}
                                                        <div class="w3-container-display" style="position: relative; display: inline-block;">
                                                            <!-- Image -->
                                                            <img src="{{asset('images/fprofile.png')}}" style="width: 60px;" class="w3-margin w3-circle"/>
                                                            <!-- Icône positionnée -->
                                                            <a href="{{ path('user_edit', {id: app.user.id}) }}" style="position: absolute; top: 58px; right: 18px;">
                                                                <i class="fas fa-edit w3-white" style="font-size: 10px; color: #007bff;"></i>
                                                            </a>
                                                        </div>
                                                    {% elseif app.user.sexe == 'Homme' %}
                                                    <div class="w3-container-display" style="position: relative; display: inline-block;">
                                                            <!-- Image -->
                                                            <img src="{{asset('images/hprofile.png')}}" style="width: 60px;" class="w3-margin w3-circle"/>
                                                            <!-- Icône positionnée -->
                                                            <a href="{{ path('user_edit', {id: app.user.id}) }}" style="position: absolute; top: 58px; right: 18px;">
                                                                <i class="fas fa-edit w3-white" style="font-size: 10px; color: #007bff;"></i>
                                                            </a>
                                                        </div>

                                                    {% endif %}
                                                        
                                                    <h6>Bonjour !</h6>
                                                    <p>{{ app.user.prenom | upper() }}</br>
                                                    <span class="w3-opacity">{{ app.user.userIdentifier }}</span></p>
                                                    <button class='w3-btn w3-round-xxlarge w3-margin-bottom w3-text-red'>Account</button>
                                                    <a href="{{ path('app_logout') }}">
                                                        <button class='w3-btn w3-round-xxlarge w3-margin-bottom w3-text-red'>Se deconnecter</button>
                                                    </a>
                                                </center>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                {# modal notification pour l'administrateur #}
                                <div class="Modal">
                                    <div id="notify" class="w3-modal">
                                        <div  class="w3-modal-content w3-animate-top">
                                            <div class=" w3-display-topmiddle w3-white w3-padding w3-round-xlarge">
                                                <span onclick="document.getElementById('notify').style.display='none'" class="w3-button w3-display-topright w3-circle">&times;</span>
                                                <center>
                                                    <div class="w3-container-display" style="position: relative; display: inline-block;">
                                                            <!-- Image -->
                                                            <img src="{{asset('images/logo.png')}}" style="width: 60px;" class="w3-margin"/>
                                                    </div>
                                                    <p>Aucun notification!</p>
                                                </center>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                {# modal bars pour l'administrateur #}
                                <div class="Modal">
                                    <div id="treebars" class="w3-modal">
                                        <div  class="w3-modal-content w3-animate-top">
                                            <div class=" w3-display-topmiddle w3-white w3-padding w3-round-xlarge">
                                                <span onclick="document.getElementById('treebars').style.display='none'" class="w3-button w3-display-topright w3-circle">&times;</span>
                                                <center>
                                                    <div class="w3-container-display" style="position: relative; display: inline-block;">
                                                            <!-- Image -->
                                                            <img src="{{asset('images/logo.png')}}" style="width: 60px;" class="w3-margin"/>
                                                    </div>
                                                    <p>Application web </br>Gerant les avancés autorisées </br>Au sein du service comptable de la </br> Direction Inter Régional de la Paositra Malagasy </br> FIANARANTSOA  301!</p>
                                                    <p class='w3-margin-bottom w3-text-blue w3-opacity'>Régle | Condition d'utilisation</p>
                                                </center>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                        </div>

        {# Vérifiez si l'utilisateur a le rôle MISSIONNAIRE #}
        {% elseif is_granted('ROLE_MISSIONNAIRE') %}


        <body class="w3-content" style="max-width:1300px">

            <!-- Sidebar/menu -->
            <nav class="w3-sidebar w3-bar-block w3-white w3-collapse w3-top" style="z-index:3;width:250px" id="mySidebar">
                <div class="w3-container w3-display-container w3-padding-16">
                    <i onclick="w3_close()" class="fa fa-remove w3-hide-large w3-button w3-display-topright"></i>
                    <h3 class="w3-wide w3-text-amber"><b>PAOSITRA MALAGASY</b></h3>
                </div>
                <div class="w3-padding-64 w3-large w3-text-grey" style="font-weight:bold">
                <h6 class="w3-text-grey w3-opacity">POUR TOI SEULEMENT</h6>
                    <a href="{{path('app_home_page')}}" class="w3-bar-item w3-text-gray w3-hover-text-amber"><i class="fa fa-fw fa-user w3-opacity"></i> Profile</a>
                    <a onclick="myAccFunc()" href="javascript:void(0)" class="w3-bar-item w3-text-amber w3-hover-text-amber" id="myBtn">Mission<i class="fa fa-caret-down"></i></a>
                        <div id="demoAcc" class="w3-bar-block w3-hide w3-padding-large w3-medium">
                            <a href="#" class="w3-bar-item w3-text-gray w3-hover-text-amber">Etat</a>
                            <a href="#" class="w3-bar-item w3-text-gray w3-hover-text-amber">En cours</a>
                            <a href="#" class="w3-bar-item w3-text-gray w3-hover-text-amber">Demander BSE</a>
                        </div>
                </div>
                <h6 class="w3-text-grey w3-opacity">POUR TOUS UTILISATEUR</h6>
                <a href="#footer" class="w3-bar-item w3-text-grey w3-padding w3-hover-text-amber"><i class="fa fa-user w3-opacity"></i> Contact</a> 
                <a href="javascript:void(0)" class="w3-bar-item w3-text-grey  w3-hover-text-amber w3-padding" onclick="document.getElementById('newsletter').style.display='block'"><i class="fa fa-user w3-opacity"></i>  Evaluer</a> 
                <a href="#footer"  class="w3-bar-item w3-text-grey w3-padding w3-hover-text-amber"><i class="fa fa-user w3-opacity"></i> Paramètres</a>
            </nav>

            <!-- Top menu on small screens -->
            <header class="w3-bar w3-top w3-hide-large w3-yellow w3-xlarge">
                <div class="w3-bar-item w3-padding-24 w3-wide w3-text-black">PAOMA</div>
                <a href="javascript:void(0)" class="w3-bar-item w3-button w3-padding-24 w3-right" onclick="w3_open()"><i class="fa fa-bars"></i></a>
            </header>

            <!-- Overlay effect when opening sidebar on small screens -->
            <div class="w3-overlay w3-hide-large" onclick="w3_close()" style="cursor:pointer" title="close side menu" id="myOverlay">  
            </div>

            <!-- !PAGE CONTENT! -->
            <div class="w3-main" style="margin-left:250px">
                <div class=" w3-margin-bottom ">
                    <div class=" w3-opacity w3-padding w3-margin-bottom">
                        <h1 class="w3-center">Mission</h1>
                    </div> 

                    <div class="w3-row w3-padding-16" >
                        <div class="w3-container w3-twothird w3-center">
                            <canvas id="myChartBse" width="400" height="180">BSE</canvas>
                        </div>

                        <div class="w3-container w3-third">
                            <h6 class="w3-center">LEGENDE</h6>
                            <p class="w3-center">Nombre des missions pendant 6 mois</br> Gouper par 1 mois </p>
                            <button class="w3-red w3-border w3-border-red w3-margin-bottom" style='width:80px'>red</button>   <span> 0% à 25% du total dans 6 mois</span><br>
                            <button class="w3-orange w3-border w3-border-orange w3-margin-bottom" style='width:80px'>Orange</button>  <span> 25% à 50% du total dans 6 mois</span><br>
                            <button class="w3-green w3-border w3-border-green w3-margin-bottom" style='width:80px'>Green</button>  <span> 50% à 75% du total dans 6 mois</span><br>
                            <button class="w3-blue w3-border w3-border-blue w3-margin-bottom" style='width:80px'>Blue</button>   <span> 75% à 100% du total dans 6 mois</span><br>
                            <button class="w3-yellow w3-border w3-border-yellow" style='width:80px'>Yellow</button> <span> Couleur par defaut</span><br>
                        </div>
                    </div>
                </div>


                <!-- Subscribe section --><hr>
                <div class="w3-container">
                    {% for item in Bse_missionnaire %}
                        <div class=" w3-display-container w3-margin w3-padding w3-panel w3-light-grey ">
                            <p class="w3-opacity w3-display-topright w3-margin-right">{{item.dateBse | date('d-m-Y')}}</p>
                            <p class="w3-margin-top">Borderau de saisi des engagements de {{app.user.titre}} {{app.user.nom | upper}} {{app.user.prenom}}, créé le {{item.dateBse | date('d-m-Y')}} à  {{item.lieuBse}}. En raison de {{item.motif}} à {{item.destination }} d'une duree de 
                            {{item.dureeMission}} jours.</p>
                            <p class="w3-">Demande: {{item.etat }}</p>

                        {###########################################}

                            {# sans BST #}
                            {% if item.etat == 'Ordre de route sans BST' %}
                                {# sans BST et en attette #}
                                {% if item.etatValidation == 'en_attente'%}
                                    <div class="w3-cell-row">
                                        <div class="w3-container w3-cell w3-mobile">
                                            <span class="w3-yellow">En attette</span>
                                            <span class="w3-grey">Départ</span>
                                            <span class="w3-grey">OR non payé</span>
                                        </div>

                                        <div class="w3-container  w3-cell w3-mobile">
                                            <p>Hello W3.CSS Layout.</p>
                                        </div>

                                    </div> 


                                {# sans BST et refusé #}
                                {% elseif item.etatValidation == 'refuse'%}
                                    <div class="w3-cell-row">
                                        <div class="w3-container w3-cell w3-mobile">
                                            <span class="w3-red">Refusé</span>
                                            <span class="w3-grey">Départ</span>
                                            <span class="w3-grey">OR non payé</span>
                                        </div>

                                        <div class="w3-container  w3-cell w3-mobile">
                                            <p>Hello W3.CSS Layout.</p>
                                        </div>

                                    </div> 

                                
                                {# sans BST et validé #}
                                {% elseif item.etatValidation == 'accepte'%}
                                    {# sans BST et validé et depart non #}
                                    {% if item.lieuDepartMissionnaire == null %}
                                        <div class="w3-cell-row">
                                            <div class="w3-container w3-cell w3-mobile">
                                                <span class="w3-green">Accepté</span>
                                                <span class="w3-red">Départ non</span>
                                                <span class="w3-grey">OR non payé</span>
                                            </div>

                                            <div class="w3-container  w3-cell w3-mobile">
                                                <p>Hello W3.CSS Layout.</p>
                                            </div>

                                        </div> 


                                    {# sans BST et validé et depart ok #}
                                    {% else %}
                                        {# sans BST et validé et depart ok et or non payé #}
                                        {% if item.etatPaymentOr == null %}
                                            <div class="w3-cell-row">
                                                <div class="w3-container w3-cell w3-mobile">
                                                    <span class="w3-green">Accepté</span>
                                                    <span class="w3-green">Départ ok</span>
                                                    <span class="w3-red">OR non payé</span>
                                                </div>

                                                <div class="w3-container  w3-cell w3-mobile">
                                                    <p>Hello W3.CSS Layout.</p>
                                                </div>

                                            </div> 

                                        {# sans BST et validé et depart ok et or payé #}
                                        {% else %}
                                            <div class="w3-cell-row">
                                                <div class="w3-container w3-cell w3-mobile">
                                                    <span class="w3-green">Accepté</span>
                                                    <span class="w3-green">Départ ok</span>
                                                    <span class="w3-green">OR payé</span>
                                                </div>

                                                <div class="w3-container  w3-cell w3-mobile">
                                                    <p>Hello W3.CSS Layout.</p>
                                                </div>

                                            </div> 

                                        {% endif %}
                                    {% endif %}

                                {% endif %}

                            {# avec BST #}
                            {% elseif item.etat == 'Ordre de route avec BST' %}
                                {# avec BST et en attette #}
                                {% if item.etatValidation == 'en_attente'%}
                                    <div class="w3-cell-row">
                                        <div class="w3-container w3-cell w3-mobile">
                                            <span class="w3-yellow">En attentte</span>
                                            <span class="w3-grey">Bst non payé</span>
                                            <span class="w3-grey">Départ non</span>
                                            <span class="w3-grey">OR non payé</span>
                                        </div>

                                        <div class="w3-container  w3-cell w3-mobile">
                                            <p>Hello W3.CSS Layout.</p>
                                        </div>

                                    </div> 

                                {# avec BST et refusé #}
                                {% elseif item.etatValidation == 'refuse'%}
                                    <div class="w3-cell-row">
                                        <div class="w3-container w3-cell w3-mobile">
                                            <span class="w3-red">Refusé</span>
                                            <span class="w3-grey">Bst non payé</span>
                                            <span class="w3-grey">Départ non</span>
                                            <span class="w3-grey">OR non payé</span>
                                        </div>

                                        <div class="w3-container  w3-cell w3-mobile">
                                            <p>Hello W3.CSS Layout.</p>
                                        </div>

                                    </div> 

                                {# avec BST et validé #}
                                {% elseif item.etatValidation == 'accepte'%}

                                    {# avec BST et validé et bst non payé #}
                                    {% if item.codePostalePaymentBst == null %}
                                        <div class="w3-cell-row">
                                            <div class="w3-container w3-cell w3-mobile">
                                                <span class="w3-green">Accepté</span>
                                                <span class="w3-red">Bst non payé</span>
                                                <span class="w3-grey">Départ non</span>
                                                <span class="w3-grey">OR non payé</span>
                                            </div>

                                            <div class="w3-container  w3-cell w3-mobile">
                                                <p>Hello W3.CSS Layout.</p>
                                            </div>

                                        </div> 

                                    {# avec BST et validé et bst payé #}
                                    {% else %}

                                        {# avec BST et validé et bst payé et depart non #}
                                        {% if item.lieuDepartMissionnaire == null %}
                                            <div class="w3-cell-row">
                                                <div class="w3-container w3-cell w3-mobile">
                                                    <span class="w3-green">Accepté</span>
                                                    <span class="w3-green">Bst payé</span>
                                                    <span class="w3-red">Départ non</span>
                                                    <span class="w3-grey">OR non payé</span>
                                                </div>

                                                <div class="w3-container  w3-cell w3-mobile">
                                                    <p>Hello W3.CSS Layout.</p>
                                                </div>

                                            </div> 
                                        
                                        {# avec BST et validé et bst payé et depart ok #}
                                        {% else %}

                                            {# avec BST et validé et bst payé et depart ok et or non payé #}
                                            {% if item.etatPaymentOr == null  %}
                                                <div class="w3-cell-row">
                                                    <div class="w3-container w3-cell w3-mobile">
                                                        <span class="w3-green">Accepté</span>
                                                        <span class="w3-green">Bst payé</span>
                                                        <span class="w3-green">Départ ok</span>
                                                        <span class="w3-red">OR non payé</span>
                                                    </div>

                                                    <div class="w3-container  w3-cell w3-mobile">
                                                        <p>Hello W3.CSS Layout.</p>
                                                    </div>

                                                </div> 

                                            {# avec BST et validé et bst payé et depart ok et or payé #}
                                            {% else %} 
                                                <div class="w3-cell-row">
                                                    <div class="w3-container w3-cell w3-mobile">
                                                        <span class="w3-green">Accepté</span>
                                                        <span class="w3-green">Bst payé</span>
                                                        <span class="w3-green">Départ ok</span>
                                                        <span class="w3-green">OR payé</span>
                                                    </div>

                                                    <div class="w3-container  w3-cell w3-mobile">
                                                        <p>Hello W3.CSS Layout.</p>
                                                    </div>

                                                </div> 

                                            {% endif %}
                                        {% endif %}
                                    {% endif %}
                                {% endif %}
                            {% endif %}
                            {###################################}
                        </div>
                    {% endfor %}
                </div>
  
                <!-- Footer -->
                <footer class="w3-padding-32 w3-light-grey w3-small w3-margin w3-center" id="footer">
                    <div class="w3-row-padding">
                        <div class="w3-third ">
                            <h4>Contact</h4>
                            <form action="https://www.w3schools.com/action_page.php" target="_blank">
                            <p><input class="w3-input w3-border" type="text" placeholder="Name" name="Name" required></p>
                            <p><input class="w3-input w3-border" type="text" placeholder="Email" name="Email" required></p>
                            <p><input class="w3-input w3-border" type="text" placeholder="Subject" name="Subject" required></p>
                            <p><input class="w3-input w3-border" type="text" placeholder="Message" name="Message" required></p>
                            <button type="submit" class="w3-button w3-block w3-amber">Send</button>
                            </form>
                        </div>

                        <div class="w3-third w3-margin-top">
                            <h4>Coordonné</h4>
                            <p class="w3-hover-text-amber"><i class="fa fa-fw fa-map-marker w3-opacity"></i> Ampasambazaha, Fianarantsoa 301</p>
                            <p class="w3-hover-text-amber"><i class="fa fa-fw fa-poste w3-opacity"></i> Fianarantsoa 301</p>
                            <p class="w3-hover-text-amber"><i class="fa fa-fw fa-site w3-opacity"></i> www.paositramalagasy.mg</p>
                            <p class="w3-hover-text-amber"><i class="fa fa-fw fa-youtube w3-opacity"></i> Paositra Malagasy</p>
                            <p class="w3-hover-text-amber"><i class="fa fa-fw fa-phone w3-opacity"></i> + 261 34 00 994 42</p>
                        </div>

                        <div class="w3-third w3-margin-top ">
                            <h4>Nos Service</h4>
                            <p class="w3-hover-text-amber"><i class="fa fa-fw fa-credit-card"></i>  Epargne postale</p>
                            <p class="w3-hover-text-amber"><i class="fa fa-fw fa-car"></i>  Transport</p>
                            <p class="w3-hover-text-amber"><i class="fa fa-fw fa-location"></i>  Location Voiture</p>
                            <p class="w3-hover-text-amber"><i class="fa fa-fw fa-dollar"></i>  Transfert d'argent</p>
                        </div>
                    </div>
                    <div class="w3-margin-top w3-padding w3-hover-text-amber">Powered by Julie Iarisoa</div>
                </footer>

            <!-- End page content -->
            </div>

            <!-- Newsletter Modal -->
            <div id="newsletter" class="w3-modal">
                <div class="w3-modal-content w3-animate-top" style="padding:32px">
                    <div class="w3-container w3-white w3-center">
                    <i onclick="document.getElementById('newsletter').style.display='none'" class="fa fa-remove w3-right w3-button w3-transparent w3-xxlarge"></i>
                    <h2 class="w3-wide">NEWSLETTER</h2>
                    <p>Join our mailing list to receive updates on new arrivals and special offers.</p>
                    <p><input class="w3-input w3-border" type="text" placeholder="Enter e-mail"></p>
                    <button type="button" class="w3-button w3-padding-large w3-red w3-margin-bottom" onclick="document.getElementById('newsletter').style.display='none'">Subscribe</button>
                    </div>
                </div>
            </div>

        </body>

        {# Vérifiez si l'utilisateur a le rôle Payeur #}
        {% elseif is_granted('ROLE_PAYEUR') %}

                    {# Contenue pour l'administrateur #}
            <div class="w3-row">

                {# bare de navigation pour l'administrateur #}
                <div class="w3-col w3-yellow" id="nav">
                    <a href="{{path('app_home_page')}}">
                        <button class="w3-button w3-block w3-left-align">
                            <i class="fa fa-home w3-opacity"></i> 
                            Acceuil
                        </button>
                    </a>
                    <a href="{{path('user_index')}}">
                        <button class="w3-button w3-block w3-left-align">
                            <i class="fa fa-users w3-opacity"></i> 
                            Missionnaire
                        </button>
                    </a>
                    <a href="{{path('bse_index')}}">
                        <button class="w3-button w3-block w3-left-align" id="active">
                            <i class="fas fa-briefcase"></i>
                            Mission
                        </button>
                    </a>
                    <a href="{{path('payment_index')}}">
                        <button class="w3-button w3-block w3-left-align">
                            <i class="fas fa-dollar-sign"></i> 
                            Payement
                        </button>
                    </a>
                    <a href="{{path('bureau_index')}}">
                        <button class="w3-button w3-block w3-left-align">
                            <i class="fas fa-building"></i>
                            Agence
                        </button>
                    </a>
                    <a href="{{path('credit_index')}}">
                        <button class="w3-button w3-block w3-left-align">
                            <i class="fas fa-sync"></i>
                            Renouveller credit
                        </button>
                    </a>
                </div>




                <div class="w3-container content-wrapper">

            <div class="w3-bar  w3-padding">
            <button class="w3-bar-item w3-button w3-blue" onclick="openModal('Creation')" id="tous">Creation</button>
            <button class="w3-bar-item w3-button" onclick="openModal('Validation')" id="bst">Validation</button>
            <button class="w3-bar-item w3-button" onclick="openModal('Refuse')" id="ordreRoute">Refuse</button>
            <div  class="w3-center w3-bar-item w3-display-topright w3-margin">
            <input class="w3-input w3-border w3-bar-item  w3-margin-right" type="text" placeholder="Rechercher un missionnaire..."id="myInput" onkeyup="myFunction('myTable','myInput',2)">
                                    <i class="fa fa-bell w3-opaModal w3-margin-left"  onclick="document.getElementById('notify').style.display='block'"></i>
                                    <i class="fa fa-user-circle w3-opaModal w3-margin-left"   onclick="document.getElementById('profile').style.display='block'"></i>
                                    <i class="fa fa-bars w3-opaModal w3-margin-left"  onclick="document.getElementById('treebars').style.display='block'"></i>
                                </div>
            </div>

            <div id="Creation" class="w3-container w3-display-container Modal">
                                {# liste Ordre de route deja paye #}
                                <div>
                                    {# Corp du Liste Ordre de route deja paye   contenue #}
                                    <div>
                                        <table class="w3-table w3-bordered"  id="myTable">
                                                <tr class="w3-light-grey">
                                                    <th>Matricule</th>
                                                    <th>Nom</th>
                                                    <th>Prenom</th>
                                                    <th>Fonction</th>
                                                    <th>Taux Journalier</th>
                                                    <th>Titre</th>
                                                    <th></th>
                                                    <th></th>
                                                    <th></th>
                                                </tr>
                                            {% for user in user %}
                                                <tr class="">
                                                    <td>{{ user.matricule }}</td>
                                                    <td>{{ user.nom }}</td>
                                                    <td>{{ user.prenom }}</td>
                                                    <td>{{ user.fonction }}</td>
                                                    <td>{{ user.tauxJournalier }}</td>
                                                    <td>{{ user.titre }}</td>
                                                    <td>
                                                        <a href="{{ path('user_show', {id: user.id}) }}" class="w3-button w3-light-grey w3-small"><i class="fas fa-eye"></i> Voir</a>
                                                    </td>
                                                    <td>
                                                        <a href="{{ path('ordreRoute_new', {id: user.matricule}) }}"><boutton class="w3-button w3-blue w3-hover-yellow">Créer OR</boutton></a>
                                                    </td>
                                                    <td>
                                                        <a href="{{ path('bst_new', {id: user.matricule}) }}"><boutton class="w3-button w3-blue w3-hover-yellow">Créer OR/BST</boutton></a>
                                                    </td>
                                                </tr>
                                            {% endfor %}
                                        </table>
                                    </div>
                                </div>
            </div>

            <div id="Validation" class="w3-container w3-display-container Modal" style="display:none">
                                    {# Corp du Liste BST non payer  contenue #}
                                    <div>
                                        <table  class="w3-table w3-bordered" id="myTableAttente">
                                            <tr class="w3-light-grey">
                                                <th>Destination</th>
                                                <th>Motif</th>
                                                <th>Création mission</th>
                                                <th>Matricule</th>
                                                <th>Durée mission</th>
                                                <th>Création mission</th>
                                                <th>Payment OR</th>
                                                <th>Validation OR</th>
                                                <th>Etat</th>
                                                <th></th>
                                                <th></th>
                                            </tr>
                                            {% for bse_validation_attente in bse_validation_attente %}
                                                <tr>
                                                    <td>{{ bse_validation_attente.destination }}</td>
                                                    <td>{{ bse_validation_attente.motif }}</td>
                                                    <td>{{ bse_validation_attente.dateBse|date('Y-m-d') }}</td>
                                                    <td>{{ bse_validation_attente.matricule }}</td>
                                                    <td>{{ bse_validation_attente.dureeMission }}</td>
                                                    <td>{{ bse_validation_attente.lieuBse}}</td>
                                                    <td>{{ bse_validation_attente.etatPaymentOr }}</td>
                                                    <td>{{ bse_validation_attente.etatValidationOr }}</td>
                                                    <td>{{ bse_validation_attente.depenseBst }}</td>
                                                    <td>{{ bse_validation_attente.etat }}</td>

                                                    {% if (bse_validation_attente.etat == 'Ordre de route sans BST') %}
                                                        <td>
                                                            <a href="{{ path('bse_valide_or', {id: bse_validation_attente.id, matricule: bse_validation_attente.matricule}) }}"><boutton class="w3-button w3-blue w3-hover-yellow">Valider</button></a>
                                                        </td>
                                                    {% elseif (bse_validation_attente.etat == 'Ordre de route avec BST')%}
                                                        <td>
                                                            <a href="{{ path('bse_valide_or_bst', {id: bse_validation_attente.id, matricule: bse_validation_attente.matricule}) }}"><boutton class="w3-button w3-blue w3-hover-yellow">Valider</button></a>
                                                        </td>
                                                    {% endif %}
                                                </tr>
                                            {% endfor %}
                                        </table>
                                    </div>
            </div>

            <div id="Refuse" class="w3-container w3-display-container Modal" style="display:none">
                                    <div>
                                        <table  class="w3-table w3-bordered" id="myTableRefuse">
                                            <tr class="w3-light-grey">
                                                <th>Destination</th>
                                                <th>Motif</th>
                                                <th>Création mission</th>
                                                <th>Matricule</th>
                                                <th>Durée mission</th>
                                                <th>Nom detenteur</th>
                                                <th>Prenom detenteur</th>
                                                <th>Fonction Detenteur</th>
                                                <th>Création mission</th>
                                                <th>Validation OR</th>
                                                <th>Etat</th>
                                                <th></th>
                                            </tr>
                                            {% for validation_refuse in validation_refuse %}
                                                <tr>
                                                    <td>{{ validation_refuse.destination }}</td>
                                                    <td>{{ validation_refuse.motif }}</td>
                                                    <td>{{ validation_refuse.dateBse|date('Y-m-d') }}</td>
                                                    <td>{{ validation_refuse.matricule }}</td>
                                                    <td>{{ validation_refuse.dureeMission }}</td>
                                                    <td>{{ validation_refuse.nomDetenteur }}</td>
                                                    <td>{{ validation_refuse.prenomDetenteur }}</td>
                                                    <td>{{ validation_refuse.fonctionDetenteur }}</td>
                                                    <td>{{ validation_refuse.lieuBse}}</td>
                                                    <td>{{ validation_refuse.etatValidationOr }}</td>
                                                    <td>{{ validation_refuse.etat }}</td>
                                                    
                                                {% if (validation_refuse.etat == 'Ordre de route sans BST') %}
                                                    <td>
                                                        <a href="{{ path('bse_edit', {id: validation_refuse.id, matricule: validation_refuse.matricule}) }}"><boutton class="w3-button w3-blue w3-hover-yellow">Modifier</button></a>
                                                    </td>
                                                {% elseif (validation_refuse.etat == 'Ordre de route avec BST')%}
                                                    <td>
                                                        <a href="{{ path('bse_edit', {id: validation_refuse.id, matricule: validation_refuse.matricule}) }}"><boutton class="w3-button w3-blue w3-hover-yellow">Modifier</button></a>
                                                    </td>
                                                {% endif %}
                                                </tr>
                                            {% endfor %}
                                        </table>
                                    </div>
            </div>



            {#
                <div>
                    {# premier contenue }
                    <div class="contenue1 w3-container content-wrapper" id="creation">
                        {# Entete du premier contenue }
                        <div>
                            <div class="w3-row-padding w3-margin-bottom">
                                <center>
                                    <h4 class="w3-text-indigo" ><b>Création d'un ordre de route avec ou sans BST</b></h4>
                                </center>
                            </div>
                            <div class="w3-row-padding w3-margin-bottom">
                                <div  class="w3-twothird">
                                    <a href="#creation"><button class="w3-button w3-yellow">Création</button></a>
                                    <a href="#validation"><button class="w3-button">Validation</button></a>
                                    <a href="#refuse"><button class="w3-button ">Refusé</button></a>
                                </div>
                                <div  class="w3-third">
                                    <input class="w3-input w3-border " type="text" placeholder="Rechercher un missionnaire..." id="myInput" onkeyup="myRecherche('myTable','myInput',1)">
                                </div>
                            </div>
                        </div>
                        
                        {# Corp du premier contenue }
                        <div id="creation" class="w3-container Mission">
                        </div>
                    </div>

                    {# deuxieme contenue }
                    <div class="contenue2 w3-container content-wrapper" id="validation">
                        {# Entete du deuxième contenue }
                        <div>
                            <div class="w3-row-padding w3-margin-bottom w3-border w3-border-indigo">
                                <center>
                                    <h4 class="w3-text-indigo" ><b>Validation d'un ordre de route avec ou sans BST</b></h4>
                                </center>
                            </div>
                            <div class="w3-row-padding w3-margin-bottom">
                                <div  class="w3-twothird">
                                    <a href="#creation"><button class="w3-button">Création</button></a>
                                    <a href="#validation"><button class="w3-button w3-yellow">Validation</button></a>
                                    <a href="#refuse"><button class="w3-button">Refusé</button></a>
                                </div>
                                <div  class="w3-third">
                                    <input class="w3-input w3-border " type="text" placeholder="Rechercher par destination..." id="myInputAttente" onkeyup="myRecherche('myTableAttente','myInputAttente',0)">
                                </div>
                            </div>
                        </div>
                        
                        {# Corp du deuxieme contenue }
                        <div id="validation" class="w3-container Mission">
                        </div>
                    </div>

                    {# troisième contenue }
                    <div class="contenue3 w3-container content-wrapper" id="refuse">
                        {# Entete du troisieme contenue }
                        <div>
                            <div class="w3-row-padding w3-margin-bottom w3-border w3-border-indigo">
                                <center>
                                    <h4 class="w3-text-indigo" ><b>Ordre de route avec ou sans BST refusé</b></h4>
                                </center>
                            </div>
                            <div class="w3-row-padding w3-margin-bottom">
                                <div  class="w3-twothird">
                                    <a href="#creation"><button class="w3-button">Création</button></a>
                                    <a href="#validation"><button class="w3-button">Validation</button></a>
                                    <a href="#refuse"><button class="w3-button w3-yellow">Refusé</button></a>
                                </div>
                                <div  class="w3-third">
                                    <input class="w3-input w3-border " type="text" placeholder="Rechercher par motif..." id="myInputRefuse" onkeyup="myRecherche('myTableRefuse','myInputRefuse',0)">
                                </div>
                            </div>
                        </div>
                        
                        {# Corp du troisieme contenue }
                        <div id="refuse" class="w3-container Mission">
                            
                        </div>
                    </div>
                </div>#}


                    {# modal profile pour l'administrateur #}
                    <div class="Modal">
                        <div id="profile" class="w3-modal">
                            <div  class="w3-modal-content w3-animate-top">
                                <div class=" w3-display-topmiddle w3-white w3-padding w3-round-xlarge">
                                    <span onclick="document.getElementById('profile').style.display='none'" class="w3-button w3-display-topright w3-circle">&times;</span>
                                    <center>
                                        {% if app.user.sexe == 'Femme' %}
                                            <div class="w3-container-display" style="position: relative; display: inline-block;">
                                                <!-- Image -->
                                                <img src="{{asset('images/fprofile.png')}}" style="width: 60px;" class="w3-margin w3-circle"/>
                                                <!-- Icône positionnée -->
                                                <a href="{{ path('user_edit', {id: app.user.id}) }}" style="position: absolute; top: 58px; right: 18px;">
                                                    <i class="fas fa-edit w3-white" style="font-size: 10px; color: #007bff;"></i>
                                                </a>
                                            </div>
                                        {% elseif app.user.sexe == 'Homme' %}
                                           <div class="w3-container-display" style="position: relative; display: inline-block;">
                                                <!-- Image -->
                                                <img src="{{asset('images/hprofile.png')}}" style="width: 60px;" class="w3-margin w3-circle"/>
                                                <!-- Icône positionnée -->
                                                <a href="{{ path('user_edit', {id: app.user.id}) }}" style="position: absolute; top: 58px; right: 18px;">
                                                    <i class="fas fa-edit w3-white" style="font-size: 10px; color: #007bff;"></i>
                                                </a>
                                            </div>

                                        {% endif %}
                                            
                                        <h6>Bonjour !</h6>
                                        <p>{{ app.user.prenom | upper() }}</br>
                                        <span class="w3-opacity">{{ app.user.userIdentifier }}</span></p>
                                        <button class='w3-btn w3-round-xxlarge w3-margin-bottom w3-text-red'>Account</button>
                                        <a href="{{ path('app_logout') }}">
                                            <button class='w3-btn w3-round-xxlarge w3-margin-bottom w3-text-red'>Se deconnecter</button>
                                        </a>
                                    </center>
                                </div>
                            </div>
                        </div>
                    </div>

                    {# modal notification pour l'administrateur #}
                    <div class="Modal">
                        <div id="notify" class="w3-modal">
                            <div  class="w3-modal-content w3-animate-top">
                                <div class=" w3-display-topmiddle w3-white w3-padding w3-round-xlarge">
                                    <span onclick="document.getElementById('notify').style.display='none'" class="w3-button w3-display-topright w3-circle">&times;</span>
                                    <center>
                                        <div class="w3-container-display" style="position: relative; display: inline-block;">
                                                <!-- Image -->
                                                <img src="{{asset('images/logo.png')}}" style="width: 60px;" class="w3-margin"/>
                                        </div>
                                        <p>Aucun notification!</p>
                                    </center>
                                </div>
                            </div>
                        </div>
                    </div>

                    {# modal bars pour l'administrateur #}
                    <div class="Modal">
                        <div id="treebars" class="w3-modal">
                            <div  class="w3-modal-content w3-animate-top">
                                <div class=" w3-display-topmiddle w3-white w3-padding w3-round-xlarge">
                                    <span onclick="document.getElementById('treebars').style.display='none'" class="w3-button w3-display-topright w3-circle">&times;</span>
                                    <center>
                                        <div class="w3-container-display" style="position: relative; display: inline-block;">
                                                <!-- Image -->
                                                <img src="{{asset('images/logo.png')}}" style="width: 60px;" class="w3-margin"/>
                                        </div>
                                        <p>Application web </br>Gerant les avancés autorisées </br>Au sein du service comptable de la </br> Direction Inter Régional de la Paositra Malagasy </br> FIANARANTSOA  301!</p>
                                        <p class='w3-margin-bottom w3-text-blue w3-opacity'>Régle | Condition d'utilisation</p>
                                    </center>
                                </div>
                            </div>
                        </div>
                    </div>
            </div>
        {# Vérifiez si l'utilisateur a le rôle USER #}
        {% elseif is_granted('ROLE_USER') %}

            {# contenue pour l'utilisateur simple #}
            {# Contenue pour l'administrateur #}
            <div class="w3-row">

                {# bare de navigation pour l'administrateur #}
                <div class="w3-col w3-yellow" id="nav">
                    <a href="{{path('app_home_page')}}">
                        <button class="w3-button w3-block w3-left-align">
                            <i class="fa fa-home w3-opacity"></i> 
                            Acceuil
                        </button>
                    </a>
                    <a href="{{path('user_index')}}">
                        <button class="w3-button w3-block w3-left-align">
                            <i class="fa fa-users w3-opacity"></i> 
                            Missionnaire
                        </button>
                    </a>
                    <a href="{{path('bse_index')}}">
                        <button class="w3-button w3-block w3-left-align" id="active">
                            <i class="fas fa-briefcase"></i>
                            Mission
                        </button>
                    </a>
                    <a href="{{path('payment_index')}}">
                        <button class="w3-button w3-block w3-left-align">
                            <i class="fas fa-dollar-sign"></i> 
                            Payement
                        </button>
                    </a>
                    <a href="{{path('bureau_index')}}">
                        <button class="w3-button w3-block w3-left-align">
                            <i class="fas fa-building"></i>
                            Agence
                        </button>
                    </a>
                    <a href="{{path('credit_index')}}">
                        <button class="w3-button w3-block w3-left-align">
                            <i class="fas fa-sync"></i>
                            Renouveller credit
                        </button>
                    </a>
                </div>




                <div class="w3-container content-wrapper">

            <div class="w3-bar  w3-padding">
            <button class="w3-bar-item w3-button w3-blue" onclick="openModal('Creation')" id="tous">Creation</button>
            <button class="w3-bar-item w3-button" onclick="openModal('Validation')" id="bst">Validation</button>
            <button class="w3-bar-item w3-button" onclick="openModal('Refuse')" id="ordreRoute">Refuse</button>
            <div  class="w3-center w3-bar-item w3-display-topright w3-margin">
            <input class="w3-input w3-border w3-bar-item  w3-margin-right" type="text" placeholder="Rechercher un missionnaire..."id="myInput" onkeyup="myFunction('myTable','myInput',2)">
                                    <i class="fa fa-bell w3-opaModal w3-margin-left"  onclick="document.getElementById('notify').style.display='block'"></i>
                                    <i class="fa fa-user-circle w3-opaModal w3-margin-left"   onclick="document.getElementById('profile').style.display='block'"></i>
                                    <i class="fa fa-bars w3-opaModal w3-margin-left"  onclick="document.getElementById('treebars').style.display='block'"></i>
                                </div>
            </div>

            <div id="Creation" class="w3-container w3-display-container Modal">
                                {# liste Ordre de route deja paye #}
                                <div>
                                    {# Corp du Liste Ordre de route deja paye   contenue #}
                                    <div>
                                        <table class="w3-table w3-bordered"  id="myTable">
                                                <tr class="w3-light-grey">
                                                    <th>Matricule</th>
                                                    <th>Nom</th>
                                                    <th>Prenom</th>
                                                    <th>Fonction</th>
                                                    <th>Taux Journalier</th>
                                                    <th>Titre</th>
                                                    <th></th>
                                                    <th></th>
                                                    <th></th>
                                                </tr>
                                            {% for user in user %}
                                                <tr class="">
                                                    <td>{{ user.matricule }}</td>
                                                    <td>{{ user.nom }}</td>
                                                    <td>{{ user.prenom }}</td>
                                                    <td>{{ user.fonction }}</td>
                                                    <td>{{ user.tauxJournalier }}</td>
                                                    <td>{{ user.titre }}</td>
                                                    <td>
                                                        <a href="{{ path('user_show', {id: user.id}) }}" class="w3-button w3-light-grey w3-small"><i class="fas fa-eye"></i> Voir</a>
                                                    </td>
                                                    <td>
                                                        <a href="{{ path('ordreRoute_new', {id: user.matricule}) }}"><boutton class="w3-button w3-blue w3-hover-yellow">Créer OR</boutton></a>
                                                    </td>
                                                    <td>
                                                        <a href="{{ path('bst_new', {id: user.matricule}) }}"><boutton class="w3-button w3-blue w3-hover-yellow">Créer OR/BST</boutton></a>
                                                    </td>
                                                </tr>
                                            {% endfor %}
                                        </table>
                                    </div>
                                </div>
            </div>

            <div id="Validation" class="w3-container w3-display-container Modal" style="display:none">
                                    {# Corp du Liste BST non payer  contenue #}
                                    <div>
                                        <table  class="w3-table w3-bordered" id="myTableAttente">
                                            <tr class="w3-light-grey">
                                                <th>Destination</th>
                                                <th>Motif</th>
                                                <th>Création mission</th>
                                                <th>Matricule</th>
                                                <th>Durée mission</th>
                                                <th>Création mission</th>
                                                <th>Payment OR</th>
                                                <th>Validation OR</th>
                                                <th>Etat</th>
                                                <th></th>
                                                <th></th>
                                            </tr>
                                            {% for bse_validation_attente in bse_validation_attente %}
                                                <tr>
                                                    <td>{{ bse_validation_attente.destination }}</td>
                                                    <td>{{ bse_validation_attente.motif }}</td>
                                                    <td>{{ bse_validation_attente.dateBse|date('Y-m-d') }}</td>
                                                    <td>{{ bse_validation_attente.matricule }}</td>
                                                    <td>{{ bse_validation_attente.dureeMission }}</td>
                                                    <td>{{ bse_validation_attente.lieuBse}}</td>
                                                    <td>{{ bse_validation_attente.etatPaymentOr }}</td>
                                                    <td>{{ bse_validation_attente.etatValidationOr }}</td>
                                                    <td>{{ bse_validation_attente.depenseBst }}</td>
                                                    <td>{{ bse_validation_attente.etat }}</td>

                                                    {% if (bse_validation_attente.etat == 'Ordre de route sans BST') %}
                                                        <td>
                                                            <a href="{{ path('bse_valide_or', {id: bse_validation_attente.id, matricule: bse_validation_attente.matricule}) }}"><boutton class="w3-button w3-blue w3-hover-yellow">Valider</button></a>
                                                        </td>
                                                    {% elseif (bse_validation_attente.etat == 'Ordre de route avec BST')%}
                                                        <td>
                                                            <a href="{{ path('bse_valide_or_bst', {id: bse_validation_attente.id, matricule: bse_validation_attente.matricule}) }}"><boutton class="w3-button w3-blue w3-hover-yellow">Valider</button></a>
                                                        </td>
                                                    {% endif %}
                                                </tr>
                                            {% endfor %}
                                        </table>
                                    </div>
            </div>

            <div id="Refuse" class="w3-container w3-display-container Modal" style="display:none">
                                    <div>
                                        <table  class="w3-table w3-bordered" id="myTableRefuse">
                                            <tr class="w3-light-grey">
                                                <th>Destination</th>
                                                <th>Motif</th>
                                                <th>Création mission</th>
                                                <th>Matricule</th>
                                                <th>Durée mission</th>
                                                <th>Nom detenteur</th>
                                                <th>Prenom detenteur</th>
                                                <th>Fonction Detenteur</th>
                                                <th>Création mission</th>
                                                <th>Validation OR</th>
                                                <th>Etat</th>
                                                <th></th>
                                            </tr>
                                            {% for validation_refuse in validation_refuse %}
                                                <tr>
                                                    <td>{{ validation_refuse.destination }}</td>
                                                    <td>{{ validation_refuse.motif }}</td>
                                                    <td>{{ validation_refuse.dateBse|date('Y-m-d') }}</td>
                                                    <td>{{ validation_refuse.matricule }}</td>
                                                    <td>{{ validation_refuse.dureeMission }}</td>
                                                    <td>{{ validation_refuse.nomDetenteur }}</td>
                                                    <td>{{ validation_refuse.prenomDetenteur }}</td>
                                                    <td>{{ validation_refuse.fonctionDetenteur }}</td>
                                                    <td>{{ validation_refuse.lieuBse}}</td>
                                                    <td>{{ validation_refuse.etatValidationOr }}</td>
                                                    <td>{{ validation_refuse.etat }}</td>
                                                    
                                                {% if (validation_refuse.etat == 'Ordre de route sans BST') %}
                                                    <td>
                                                        <a href="{{ path('bse_edit', {id: validation_refuse.id, matricule: validation_refuse.matricule}) }}"><boutton class="w3-button w3-blue w3-hover-yellow">Modifier</button></a>
                                                    </td>
                                                {% elseif (validation_refuse.etat == 'Ordre de route avec BST')%}
                                                    <td>
                                                        <a href="{{ path('bse_edit', {id: validation_refuse.id, matricule: validation_refuse.matricule}) }}"><boutton class="w3-button w3-blue w3-hover-yellow">Modifier</button></a>
                                                    </td>
                                                {% endif %}
                                                </tr>
                                            {% endfor %}
                                        </table>
                                    </div>
            </div>



            {#
                <div>
                    {# premier contenue }
                    <div class="contenue1 w3-container content-wrapper" id="creation">
                        {# Entete du premier contenue }
                        <div>
                            <div class="w3-row-padding w3-margin-bottom">
                                <center>
                                    <h4 class="w3-text-indigo" ><b>Création d'un ordre de route avec ou sans BST</b></h4>
                                </center>
                            </div>
                            <div class="w3-row-padding w3-margin-bottom">
                                <div  class="w3-twothird">
                                    <a href="#creation"><button class="w3-button w3-yellow">Création</button></a>
                                    <a href="#validation"><button class="w3-button">Validation</button></a>
                                    <a href="#refuse"><button class="w3-button ">Refusé</button></a>
                                </div>
                                <div  class="w3-third">
                                    <input class="w3-input w3-border " type="text" placeholder="Rechercher un missionnaire..." id="myInput" onkeyup="myRecherche('myTable','myInput',1)">
                                </div>
                            </div>
                        </div>
                        
                        {# Corp du premier contenue }
                        <div id="creation" class="w3-container Mission">
                        </div>
                    </div>

                    {# deuxieme contenue }
                    <div class="contenue2 w3-container content-wrapper" id="validation">
                        {# Entete du deuxième contenue }
                        <div>
                            <div class="w3-row-padding w3-margin-bottom w3-border w3-border-indigo">
                                <center>
                                    <h4 class="w3-text-indigo" ><b>Validation d'un ordre de route avec ou sans BST</b></h4>
                                </center>
                            </div>
                            <div class="w3-row-padding w3-margin-bottom">
                                <div  class="w3-twothird">
                                    <a href="#creation"><button class="w3-button">Création</button></a>
                                    <a href="#validation"><button class="w3-button w3-yellow">Validation</button></a>
                                    <a href="#refuse"><button class="w3-button">Refusé</button></a>
                                </div>
                                <div  class="w3-third">
                                    <input class="w3-input w3-border " type="text" placeholder="Rechercher par destination..." id="myInputAttente" onkeyup="myRecherche('myTableAttente','myInputAttente',0)">
                                </div>
                            </div>
                        </div>
                        
                        {# Corp du deuxieme contenue }
                        <div id="validation" class="w3-container Mission">
                        </div>
                    </div>

                    {# troisième contenue }
                    <div class="contenue3 w3-container content-wrapper" id="refuse">
                        {# Entete du troisieme contenue }
                        <div>
                            <div class="w3-row-padding w3-margin-bottom w3-border w3-border-indigo">
                                <center>
                                    <h4 class="w3-text-indigo" ><b>Ordre de route avec ou sans BST refusé</b></h4>
                                </center>
                            </div>
                            <div class="w3-row-padding w3-margin-bottom">
                                <div  class="w3-twothird">
                                    <a href="#creation"><button class="w3-button">Création</button></a>
                                    <a href="#validation"><button class="w3-button">Validation</button></a>
                                    <a href="#refuse"><button class="w3-button w3-yellow">Refusé</button></a>
                                </div>
                                <div  class="w3-third">
                                    <input class="w3-input w3-border " type="text" placeholder="Rechercher par motif..." id="myInputRefuse" onkeyup="myRecherche('myTableRefuse','myInputRefuse',0)">
                                </div>
                            </div>
                        </div>
                        
                        {# Corp du troisieme contenue }
                        <div id="refuse" class="w3-container Mission">
                            
                        </div>
                    </div>
                </div>#}


                    {# modal profile pour l'administrateur #}
                    <div class="Modal">
                        <div id="profile" class="w3-modal">
                            <div  class="w3-modal-content w3-animate-top">
                                <div class=" w3-display-topmiddle w3-white w3-padding w3-round-xlarge">
                                    <span onclick="document.getElementById('profile').style.display='none'" class="w3-button w3-display-topright w3-circle">&times;</span>
                                    <center>
                                        {% if app.user.sexe == 'Femme' %}
                                            <div class="w3-container-display" style="position: relative; display: inline-block;">
                                                <!-- Image -->
                                                <img src="{{asset('images/fprofile.png')}}" style="width: 60px;" class="w3-margin w3-circle"/>
                                                <!-- Icône positionnée -->
                                                <a href="{{ path('user_edit', {id: app.user.id}) }}" style="position: absolute; top: 58px; right: 18px;">
                                                    <i class="fas fa-edit w3-white" style="font-size: 10px; color: #007bff;"></i>
                                                </a>
                                            </div>
                                        {% elseif app.user.sexe == 'Homme' %}
                                           <div class="w3-container-display" style="position: relative; display: inline-block;">
                                                <!-- Image -->
                                                <img src="{{asset('images/hprofile.png')}}" style="width: 60px;" class="w3-margin w3-circle"/>
                                                <!-- Icône positionnée -->
                                                <a href="{{ path('user_edit', {id: app.user.id}) }}" style="position: absolute; top: 58px; right: 18px;">
                                                    <i class="fas fa-edit w3-white" style="font-size: 10px; color: #007bff;"></i>
                                                </a>
                                            </div>

                                        {% endif %}
                                            
                                        <h6>Bonjour !</h6>
                                        <p>{{ app.user.prenom | upper() }}</br>
                                        <span class="w3-opacity">{{ app.user.userIdentifier }}</span></p>
                                        <button class='w3-btn w3-round-xxlarge w3-margin-bottom w3-text-red'>Account</button>
                                        <a href="{{ path('app_logout') }}">
                                            <button class='w3-btn w3-round-xxlarge w3-margin-bottom w3-text-red'>Se deconnecter</button>
                                        </a>
                                    </center>
                                </div>
                            </div>
                        </div>
                    </div>

                    {# modal notification pour l'administrateur #}
                    <div class="Modal">
                        <div id="notify" class="w3-modal">
                            <div  class="w3-modal-content w3-animate-top">
                                <div class=" w3-display-topmiddle w3-white w3-padding w3-round-xlarge">
                                    <span onclick="document.getElementById('notify').style.display='none'" class="w3-button w3-display-topright w3-circle">&times;</span>
                                    <center>
                                        <div class="w3-container-display" style="position: relative; display: inline-block;">
                                                <!-- Image -->
                                                <img src="{{asset('images/logo.png')}}" style="width: 60px;" class="w3-margin"/>
                                        </div>
                                        <p>Aucun notification!</p>
                                    </center>
                                </div>
                            </div>
                        </div>
                    </div>

                    {# modal bars pour l'administrateur #}
                    <div class="Modal">
                        <div id="treebars" class="w3-modal">
                            <div  class="w3-modal-content w3-animate-top">
                                <div class=" w3-display-topmiddle w3-white w3-padding w3-round-xlarge">
                                    <span onclick="document.getElementById('treebars').style.display='none'" class="w3-button w3-display-topright w3-circle">&times;</span>
                                    <center>
                                        <div class="w3-container-display" style="position: relative; display: inline-block;">
                                                <!-- Image -->
                                                <img src="{{asset('images/logo.png')}}" style="width: 60px;" class="w3-margin"/>
                                        </div>
                                        <p>Application web </br>Gerant les avancés autorisées </br>Au sein du service comptable de la </br> Direction Inter Régional de la Paositra Malagasy </br> FIANARANTSOA  301!</p>
                                        <p class='w3-margin-bottom w3-text-blue w3-opacity'>Régle | Condition d'utilisation</p>
                                    </center>
                                </div>
                            </div>
                        </div>
                    </div>
            </div>

        {% endif %}

        <script>

                    // Accordion 
            function myAccFunc() {
                var x = document.getElementById("demoAcc");
                if (x.className.indexOf("w3-show") == -1) {
                    x.className += " w3-show";
                } else {
                    x.className = x.className.replace(" w3-show", "");
                }
                }

                // Click on the "Jeans" link on page load to open the accordion for demo purposes
                document.getElementById("myBtn").click();


                // Open and close sidebar
                function w3_open() {
                document.getElementById("mySidebar").style.display = "block";
                document.getElementById("myOverlay").style.display = "block";
            }
            
            function w3_close() {
                document.getElementById("mySidebar").style.display = "none";
                document.getElementById("myOverlay").style.display = "none";
            }






            /// Fonction pour générer une couleur en fonction de la valeur
            function getColorForValue(value, total) {
                const quart = total / 4;

                if (value <= quart) {
                    return 'red'; // Rouge pour les valeurs très faibles
                } else if (value > quart && value <= 2 * quart) {
                    return 'orange'; // Vert pour les valeurs faibles à moyennes
                } else if (value > 2 * quart && value <= 3 * quart) {
                    return 'green'; // Bleu pour les valeurs moyennes
                } else if (value > 3 * quart && value <= total) {
                    return 'blue'; // Orange pour les valeurs élevées
                } else {
                    return 'yellow'; // Couleur par défaut
                }
            }

            const dataBsetotal6mois = {{ dataBse6Mois|raw }}; // Vérifiez bien que cette variable est correctement générée côté serveur.

            // Fonction générique pour créer un graphique avec des couleurs dynamiques en bar
            function createChart(canvasId, chartData, chartLabel) {
                const ctx = document.getElementById(canvasId).getContext('2d');

                // Générer les couleurs en fonction des valeurs
                const total = chartData.values.reduce((sum, val) => sum + val, 0); // Somme totale pour les pourcentages
                const barColors = chartData.values.map(value => getColorForValue(value, total));

                new Chart(ctx, {
                    type: 'bar',
                    data: {
                        labels: chartData.labels, // Labels des barres (ex. mois)
                        datasets: [{
                            label: chartLabel,
                            data: chartData.values,
                            backgroundColor: barColors,
                            borderColor: barColors,
                            borderWidth: 1
                        }]
                    },
                    options: {
                        scales: {
                            y: {
                                beginAtZero: true // L'axe Y commence à 0
                            }
                        }
                    }
                });
            }

            // Données des graphiques passées depuis Symfony
            const dataBse = {{ dataBse|raw }};

            // Créer les graphiques
            createChart('myChartBse', dataBse, 'BSE - Valeurs');






            function openModal(modaName) {
                var i;
                var x = document.getElementsByClassName("Modal");
                for (i = 0; i < x.length; i++) {
                    x[i].style.display = "none";  
                }
                document.getElementById(modaName).style.display = "block";  
                if(modaName === 'Creation')
                {
                    document.getElementById('tous').style.background = "blue"; 
                    document.getElementById('bst').style.background = "white"; 
                    document.getElementById('ordreRoute').style.background = "white"; 
                }
                else if(modaName === 'Validation')
                {
                    document.getElementById('tous').style.background = "white"; 
                    document.getElementById('bst').style.background = "blue"; 
                    document.getElementById('ordreRoute').style.background = "white"; 
                }
                else if(modaName === 'Refuse')
                {
                    document.getElementById('tous').style.background = "white"; 
                    document.getElementById('bst').style.background = "white"; 
                    document.getElementById('ordreRoute').style.background = "blue"; 
                }else{

                }
            }



            {# script pour le bare de recherche #}
            function myFunction(idTable, idInput) {
                var input, filter, table, tr, td1, td2, i, txtValue1, txtValue2;
                input = document.getElementById(idInput);
                filter = input.value.toUpperCase(); // Valeur à rechercher
                table = document.getElementById(idTable);
                tr = table.getElementsByTagName("tr");

                for (i = 1; i < tr.length; i++) { // Commence après l'en-tête
                    td0 = tr[i].getElementsByTagName("td")[0]; // Colonne matricule
                    td1 = tr[i].getElementsByTagName("td")[1]; // Colonne nom
                    td2 = tr[i].getElementsByTagName("td")[2]; // Colonne prenom
                    td3 = tr[i].getElementsByTagName("td")[3]; // Colonne fonction

                    txtValue0 = td0 ? td0.textContent || td0.innerText : ""; // Texte de la colonne matricule
                    txtValue1 = td1 ? td1.textContent || td1.innerText : ""; // Texte de la colonne nom
                    txtValue2 = td2 ? td2.textContent || td2.innerText : ""; // Texte de la colonne prenom
                    txtValue3 = td3 ? td3.textContent || td3.innerText : ""; // Texte de la colonne fonction

                    // Vérifie si le filtre correspond à la colonne ,matricule ou nom ou prenom
                    if (txtValue0.toUpperCase().indexOf(filter) > -1 || txtValue1.toUpperCase().indexOf(filter) > -1 || txtValue2.toUpperCase().indexOf(filter) > -1 || txtValue3.toUpperCase().indexOf(filter) > -1) {
                        tr[i].style.display = ""; // Affiche la ligne
                    } else {
                        tr[i].style.display = "none"; // Masque la ligne
                    }
                }
            }
            
        </script>
    </body>
</html>